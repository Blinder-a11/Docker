# Урок 5. Docker Compose и Docker Swarm
## Classwork
Знакомились с работой Docker Compose и Docker Swarm
## Homework 
### Задание 1:
1) создать сервис, состоящий из 2 различных контейнеров: 1 - веб, 2 - БД
2) далее необходимо создать 3 сервиса в каждом окружении (dev, prod, lab)
3) по итогу на каждой ноде должно быть по 2 работающих контейнера
4) выводы зафиксировать

### Задание 2*:
1) нужно создать 2 ДК-файла, в которых будут описываться сервисы
2) повторить задание 1 для двух окружений: lab, dev
3) обязательно проверить и зафиксировать результаты, чтобы можно было выслать преподавателю для проверки

Задание со звездочкой - повышенной сложности, это нужно учесть при выполнении (но сделать его необходимо).

### или (если нет возможности создать вторую node)
1) Создать 2 ДК-файла, в которых будут описываться сервисы состоящие из двух контейнеров: 1 - веб, 2 - БД
2) Сделать реплики контейнеров воспользовавшись сервисом Docker Swarm;
3) Проверить работоспособность контейнеров.

**Термины**

Для того чтобы пользоваться swarm, надо запомнить несколько типов сущностей:

Node - это наши виртуальные машины, на которых установлен docker. Есть manager и workers ноды. Manager нода управляет 
workers нодами. Она отвечает за создание/обновление/удаление сервисов на workers, а также за их масштабирование и 
поддержку в требуемом состоянии. Workers ноды используются только для выполнения поставленных задач и не могут управлять 
кластером.

Stack - это набор сервисов, которые логически связаны между собой. По сути это набор сервисов, которые мы описываем в 
обычном compose файле. Части stack (services) могут располагаться как на одной ноде, так и на разных.

Service - это как раз то, из чего состоит stack. Service является описанием того, какие контейнеры будут создаваться. 
Если вы пользовались docker-compose.yaml, то уже знакомы с этой сущностью. Кроме стандартных полей docker в режиме swarm 
поддерживает ряд дополнительных, большинство из которых находятся внутри секции deploy.

Task - это непосредственно созданный контейнер, который docker создал на основе той информации, которую мы указали при 
описании service. Swarm будет следить за состоянием контейнера и при необходимости его перезапускать или перемещать на 
другую ноду.

**Первый вариант решение(без использования второй node):**

Создаем два ДК-файла:

![1_1](DAC/1_1.JPG)

![1_2](DAC/1_2.JPG)

Компилируем node:

![1_3](DAC/1_3.JPG)

Проверяем:

![1_4](DAC/1_4.JPG)

Пытаемся задеплоить в Stack:

![1_5_1](DAC/1_5_1.JPG)

![1_5_2](DAC/1_5_2.JPG)

Получаем ошибку: "версия данного файла не поддерживается", продолжаем делать, как делали на семинаре.
Запускаем первый ДК-файл:

![1_7](DAC/1_7.JPG)

Проверяем:

![1_8](DAC/1_8.JPG)

![1_9](DAC/1_9.JPG)

Запускаем второй ДК-файл:

![1_10_1](DAC/1_10_1.JPG)

![1_10_1](DAC/1_10_1.JPG)

![1_11](DAC/1_11.JPG)

Воспользуемся функционалом Docker Swarm и создадим дубликат одного и того же образа:

![1_12](DAC/1_12.JPG)

![1_13](DAC/1_13.JPG)

Аналогично можем проделать с другими образами, далее повязать их сетью и получить полные дубликаты: БД + WEB.
